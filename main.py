#!/usr/bin/python

import argparse
import config
import crawler
import db
import extractor
import itertools
import models
import net
import stats

parser = argparse.ArgumentParser(description="Crawl CVE records")
parser.add_argument("--gusername", type=str, help="github username")
parser.add_argument("--gpassword", type=str, help="github password")
parser.add_argument("--updatenvd", type=bool, help="update nvd feeds", default=False)
parser.parse_args(namespace=config)
if config.gusername and config.gpassword:
    net.set_github_auth()
else:
    print "Warning: github auth not set. There'll be a limit of requests/hour"

if config.updatenvd:
    crawler.crawl_nist_feed(parallel=False)
crawler.crawl_linux_kernel_cves()
crawler.crawl_android_cve_checker(local=False)
crawler.crawl_django()
crawler.crawl_debian_security(local=True, parallel=True)
crawler.crawl_vuln_db(local=True, parallel=False)
crawler.crawl_debian_fake_names(parallel=True)
# extractor.dump_commits()
