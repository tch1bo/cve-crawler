{% extends "base.html" %}

{% block content %}
<h1>Search Vulnerabilities</h1>
    <form action="" method="post">
        <p>
            {{ form.regex_field.label }}<br>
            {{ form.regex_field(size=32) }}
        </p>
        <p>
            {{ form.cwe_field.label }}<br>
            {{ form.cwe_field() }}
        </p>
        <p>{{ form.submit() }}</p>
    </form>

{% for lang in languages %}
  {% if results[lang] %}
    <h2> {{ lang }} ({{ results[lang].__len__() }})</h2>
    <ol type="1">
    {% for r in results[lang] %}
      <li>
        (<a href={{ r.url }}> View in goodrules </a>)
        (<a href="/hash_search/{{ r.commit_hash }}"> View commit here </a>)
        <p> {{ r.msg }} </p>
      </li>
    {% endfor %}
    </ol>
  {% endif %}
{% endfor %}
{% endblock %}
