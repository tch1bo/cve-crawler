#!/bin/bash

source "./common.sh"

db_path="/home/chibo/crawler/src/data/db.sqlite3"
total_cves=`query_db "select count(*) from cve;"`

unique_cves=`query_db "select count(distinct cve_id) from cve_to_url;"`
urls_matched_to_cves=`query_db "select count(distinct url_id) from cve_to_url;"`

unique_non_cves=`query_db "select count(distinct non_cve_id) from non_cve_to_url;"`
urls_matched_to_non_cves=`query_db "select count(distinct url_id) from non_cve_to_url;"`

total_hashes=`query_db "select count(*) from hash;"`

echo "CVEs: $unique_cves"
echo "NonCVEs: $unique_non_cves"
echo "Total: `sum $unique_cves $unique_non_cves` out of $total_cves"
echo "------------------------"
echo "CVE urls: $urls_matched_to_cves"
echo "NonCVE urls: $unique_non_cves"
echo "Total: `sum $urls_matched_to_cves $urls_matched_to_non_cves`"
echo "------------------------"
echo "Total hashes: $total_hashes"
